#!/usr/bin/env python
# -*- coding=utf-8 -*-
from core.controllers.decorator import singleton


@singleton
class VulnerabilityDatabase(object):
    def __init__(self):
        self.database = []

    def filter(self, name=None, plugin_name=None):
        ret = self.database
        if name:
            ret = filter(lambda vuln: vuln.name == name, ret)
        if plugin_name:
            ret = filter(lambda vuln: vuln.plugin_name == plugin_name, ret)
        return ret

    def add(self, vulnerability):
        self.database.append(vulnerability)

    def list_database(self):
        return self.database


if __name__ == '__main__':
    t1 = VulnerabilityDatabase()
    t1.add("AAA")
    t2 = VulnerabilityDatabase()
    t2.add("BBB")

    print VulnerabilityDatabase().list_database()
